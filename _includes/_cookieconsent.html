<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css" />
<script src="{{ site.url }}{{ site.baseurl }}/assets/js/cookieconsent.js"></script>
<script>

function enableEmbeds() {
  $('.embed-video').each(function() {
    var videoId = $(this).data('video');
    var videoSource = $(this).data('video-source');
    if (videoSource === 'vimeo') {
      $(this).html(
        '<p class="embed-video-enabled">'
        + '<iframe src="https://player.vimeo.com/video/' + videoId + '?title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen>'
        + '</iframe>'
        + '</p>'
      );
    }
  })
}

function disableEmbeds() {
  $('.embed-video').each(function() {
    var videoId = $(this).data('video');
    var videoSource = $(this).data('video-source');
    if (videoSource === 'vimeo') {
      var url = '//vimeo.com/'+videoId;
      var anchor = 'vimeo.com/'+videoId;
      $(this).html(
        '<p class="embed-video-disabled" style="position:absolute;top:0;">'
        + 'Please allow third-party services to show the embedded video or watch the video on Vimeo:'
        + '<a target="_blank" href="'+url+'">' + anchor + '</a>'
        + '</p>'
      );
    }
  })
}

window.addEventListener("load", function(){
  window.cookieconsent.initialise({
    "palette": {
      "popup": {
        "background": "#000"
      },
      "button": {
        "background": "#f1d600"
      }
    },
    "position": "bottom-left",
    "type": "opt-in",
    "layout": "basic-header",
    "content": {
      "header": "Cookie preference & privacy",
      "message": "By using this Website you agree to store your Personal Data where it is essential for the Website to function. \
        In addition, you can enable non-essential third-party services that may store Cookies and Usage Data.",
      "allow": "Allow third-party services",
      "deny": "Decline",
      "link": "Our privacy policy",
      "href": "{{site.baseurl}}/privacy-policy/",
      "policy": "Cookie preference & privacy",
      "target": "",
    },
    onInitialise: function () {
      if (this.hasConsented()) {
        // enable cookies
        enableEmbeds();
      } else {
        disableEmbeds()
      }
    },

    onStatusChange: function(status, chosenBefore) {
      if (this.hasConsented()) {
        enableEmbeds();
      } else {
        disableEmbeds()
      }
    },
  })
});
</script>
